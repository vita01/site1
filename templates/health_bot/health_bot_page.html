<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ó–¥–æ—Ä–æ–≤—ã–π –±–æ—Ç ‚Äî Lovetoself</title>
  <link href="/static/css/styles.css" rel="stylesheet" />
 
</head>
<body class="bg-gradient-to-tr from-green-50 via-white to-green-100 min-h-screen flex flex-col">

  <!-- –®–∞–ø–∫–∞ -->
  <header class="bg-white shadow-md sticky top-0 z-50">
    <h1>–¢–µ—Å—Ç —à–∞–±–ª–æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç</h1>

    <div class="container mx-auto px-4 py-4 flex justify-between items-center">
      <a href="/" class="text-2xl font-bold text-green-700">üåø Lovetoself</a>
      <nav class="space-x-4">
        <a href="/" class="text-gray-600 hover:text-green-700">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
      </nav>
    </div>
  </header>


  <textarea id="question" rows="4" placeholder="–ù–∞–ø–∏—à–∏ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å..."></textarea>
<button onclick="askBot()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
<div id="answer" style="display:none; margin-top:10px; border:1px solid green; padding:10px;"></div>

<button onclick="console.log('–ö–Ω–æ–ø–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç'); askBot()">–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–Ω–æ–ø–∫–∏</button>



  <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
  <main class="flex-grow flex items-center justify-center px-4">
    <div class="max-w-xl w-full bg-white rounded-3xl shadow-xl p-8 border border-green-100">
      <h1 class="text-3xl font-semibold text-green-700 mb-4">ü§ñ –ó–¥–æ—Ä–æ–≤—ã–π –±–æ—Ç</h1>
      <p class="text-gray-600 mb-6">–°–ø—Ä–æ—Å–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å –æ –∑–¥–æ—Ä–æ–≤—å–µ, –ø–∏—Ç–∞–Ω–∏–∏ –∏–ª–∏ –ø—Ä–∏–≤—ã—á–∫–∞—Ö ‚Äî –∏ —è –ø–æ–º–æ–≥—É!</p>

      <textarea id="question" rows="3" class="w-full p-4 border rounded-xl focus:outline-none focus:ring-2 focus:ring-green-400" placeholder="–ù–∞–ø–∏—à–∏ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å..."></textarea>

      <button onclick="askBot()" class="mt-4 w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 rounded-xl transition">
        –û—Ç–ø—Ä–∞–≤–∏—Ç—å
      </button>

      <div id="answer" class="mt-6 p-4 bg-green-100 text-green-900 rounded-xl hidden whitespace-pre-line shadow-inner"></div>
    </div>
  </main>

  <!-- –ü–æ–¥–≤–∞–ª -->
  <footer class="bg-white border-t mt-12 py-4 text-center text-sm text-gray-500">
    ¬© 2025 Lovetoself ‚Äî –∑–∞–±–æ—Ç—å—Å—è –æ —Å–µ–±–µ üå±
  </footer>

  <!-- JS -->
  <script>
     // –ü–æ–ª—É—á–∏—Ç—å CSRF —Ç–æ–∫–µ–Ω –∏–∑ cookies
  function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== "") {
      const cookies = document.cookie.split(";");
      for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i].trim();
        if (cookie.substring(0, name.length + 1) === name + "=") {
          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
          break;
        }
      }
    }
    return cookieValue;
  }

  const csrftoken = getCookie("csrftoken");
    async function askBot() {
      const question = document.getElementById("question").value.trim();
      const answerBox = document.getElementById("answer");
      answerBox.classList.add("hidden");

      if (!question) return;

      answerBox.innerText = "‚è≥ –î—É–º–∞—é...";
      answerBox.classList.remove("hidden");

      try {
        const response = await fetch("/api/ask_bot/", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ question }),
        });

        const data = await response.json();
        answerBox.innerText = data.answer || data.error || "‚ö†Ô∏è –ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫";
      } catch (e) {
        answerBox.innerText = "‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º";
      }
    }
  </script>

</body>
</html>
